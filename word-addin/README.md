# 論理の飛躍スタンプ拡張機能（ロンリちゃん🪽）

Microsoft Word用のアドインとして実装された、論理の飛躍を検出してスタンプを押す可愛い拡張機能です。

## 機能

### 🔍 論理の飛躍検出
- **パターンマッチング**: 「だから」「したがって」などの論理接続詞を使用した飛躍を検出
- **文体分析**: 整いすぎた文体やAI生成っぽい文章を検出
- **ランダム検出**: 直感的な検出機能（設定可能な確率）
- **コンテキスト評価**: 前後の文脈から論理の飛躍度をスコアリング

### ✨ ロンリちゃんアニメーション
- 印面と翼を使った可愛いアニメーション
- ふわふわ浮遊＋羽ばたきエフェクト
- 検出時の効果音

### 📜 履歴管理
- 押印履歴の保存と表示
- 統計情報（総押印数、平均スコア等）
- ローカルストレージによる永続化

### ⚙️ カスタマイズ設定
- ランダム検出率の調整（0-20%）
- 効果音のオン/オフ
- テーマ設定（将来拡張予定）

## プロジェクト構成

```
ロンリちゃん/
├── assets/                    # 画像アセット
│   ├── 印面.png              # ロンリちゃん本体
│   └── 論理の翼.png          # 翼パーツ
├── src/
│   ├── detector/              # 検出エンジン
│   │   ├── LogicLeapDetector.ts   # メイン検出ロジック
│   │   └── StorageManager.ts       # データ管理
│   └── taskpane/              # UI
│       ├── taskpane.html      # メインHTML
│       ├── taskpane.ts        # メインロジック
│       └── taskpane.css       # スタイル
├── manifest.xml               # アドイン設定
└── package.json              # 依存関係
```

## 開発・実行

### 必要環境
- Node.js v18.x以上
- npm v10.x以上
- Microsoft Word（デスクトップ版）

### インストール
```powershell
npm install
```

### 開発サーバー起動
```powershell
npm start
```

これにより、Wordが自動的に起動し、アドインがサイドロードされます。

### ビルド
```powershell
npm run build
```

## 使い方

1. Wordで文書を開く
2. 「ホーム」タブの「作業ウィンドウの表示」をクリック
3. 「論理の飛躍を検出」ボタンをクリック
4. ロンリちゃんが論理の飛躍を見つけてくれます！

### 手動押印
テキストを選択して「選択範囲に押印」ボタンを押すと、手動でスタンプを押すこともできます。

## 技術スタック

- **TypeScript**: 型安全な開発
- **Office.js**: Word API連携
- **Webpack**: モジュールバンドル
- **CSS3**: アニメーション実装

## 検出アルゴリズム

### 1. パターンベース検出
論理接続詞（「だから」「したがって」など）の周辺文脈を分析し、飛躍度をスコアリング。

### 2. 文体分析
同じ表現の繰り返しや、定型的すぎる文章構造を検出。

### 3. ランダム検出
「なんとなく気になりました🪽」「勘です✨」など、ユーモラスなメッセージで直感的検出。

### 4. コンテキスト評価
- 前後の文章の長さ
- 論理接続詞の密度
- 文末表現のパターン

これらを総合してスコアを算出（0-100点）。

## カスタマイズ

### 検出感度の調整
設定画面でランダム検出率を0-20%の範囲で調整可能。

### 効果音
効果音のオン/オフを切り替え可能。

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 作者

furukawa1020

## 謝辞

- Google Docs版から移植
- ロンリちゃんのデザイン：オリジナルキャラクター
- Office.js APIドキュメント：Microsoft

---

**ロンリちゃんと一緒に、論理的な文章を書きましょう！🪽**
